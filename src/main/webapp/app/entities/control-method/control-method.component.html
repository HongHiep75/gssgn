<div  *ngIf="loading">
    <div class="loader" >
        <div class="loader-inner">
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
        </div>
    </div>
</div>
<div class='' xmlns="http://www.w3.org/1999/html">
    <!-----------    toart ---------------------->
    <div class="toart-cus" *ngIf="success">
        <svg  xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-plus-circle-fill mr-2" viewBox="0 0 16 16">
            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"/>
        </svg> Cập nhật thành công!</div>

    <div (click)="danger = false" *ngIf="danger" class="toart-close" style="background-color: red" >
        <div class="pt-1"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-x-circle-fill mr-1" viewBox="0 0 16 16">
            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"/>
        </svg> Cập nhật không thành công!</div>
    </div>


    <!----------- end   toart ---------------------->
    <div class='card jh-card' style="margin: 0px 0px 10px 0px">
        <h2><b>HỆ THỐNG KIỂM SOÁT TẬP TRUNG </b></h2>
    </div>
    <div  style="position: relative;margin-bottom: 10px">
        <p>Trang chủ >> Quản trị danh mục >> Danh mục phương thức kiểm soát</p>
    </div>
    <div style="margin-top: 10px" class='card jh-card'>
        <div class="row" >
            <div class='col-12 col-sm-7'>
                <h3><b>Danh mục phương thức kiểm soát</b></h3>
            </div>

            <!--     button   them moi-->
            <div class='col-12 col-sm-5 text-right pr-sm-1 '>
                <button class='mat-raised-button mat-accent btn cus-btn mr-sm-4'  (click)="openLg(content)"><svg  xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-circle-fill " viewBox="0 0 16 16">
                    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"/>
                </svg> Thêm mới</button>
            </div>
            <!--   end  button   them moi-->
    </div>
    </div>

    <div class='card jh-card table-custom' style="margin-top: 3px">
        <!---------------        search            --------------->
        <form [formGroup]="formSearch">
            <div class='row'>
                <div class='col-12 col-sm-5 row'>
                    <label  class='col-5 col-form-label text-left text-sm-right'><b>Mã phương thức</b></label>
                    <div class='col-7'>
                        <input type='text' style="margin-left: 1px" class='form-control' formControlName="code" >
                    </div>
                </div>
                <div class='col-12 col-sm-5 row mt-2'>
                    <label class='col-5 col-form-label text-left text-sm-right'><b>Trạng thái</b></label>
                    <div class='col-7'>
                        <select style="padding-left: 2px"  class="form-control col-12" formControlName="status">
                            <option [selected]="formSearch.value.status == 0"  value="0">[Tất cả]</option>
                            <option [selected]="formSearch.value.status == 1"  value="1">Đang hoạt động</option>
                            <option [selected]="formSearch.value.status == 2"  value="2">Dừng hoạt động</option>
                        </select>
                    </div>
                </div>
                <div class='col-12 col-sm-5 row mt-2 mt-sm-0'>
                    <label class='col-5 col-form-label text-left text-sm-right'><b>Tên phương thức</b></label>
                    <div class='col-7' >
                        <input type='text' class='form-control' formControlName="name">
                    </div>
                </div>

                <div style="padding-right: 0px" class='col-12  col-sm-7 text-right mt-2'>
                    <button class='mat-raised-button mat-accent btn cus-btn mr-3 mr-sm-0' (click)="search()"  style='padding-left: 0px;padding-right: 0px;width: 112px'>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search"
                             viewBox="0 0 16 16">
                            <path
                                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                        </svg>
                        Tìm kiếm</button>
                </div>

            </div>
        </form>

        <!---------------    end    search            --------------->

        <!---------------        table                --------------->
        <div  class='row mt-3 table-responsive'>
            <table  class="table table-bordered table-hover">
                <thead>
                <tr style="border: 0px" class="text-center">
                    <th scope="col">TT</th>
                    <th scope="col">Mã phương thức</th>
                    <th scope="col">Tên phương thức</th>
                    <th scope="col">Mô tả</th>
                    <th scope="col">Trạng thái</th>
                    <th scope="col">Thao tác</th>
                </tr>
                </thead>
                <tbody *ngIf="controlMethodList">
                <tr class="text-center" *ngFor="let value of controlMethodList; index as i">
                    <td scope="row">{{this.size*this.indexPage + 1 + i}}</td>
                    <td>{{value.code}}</td>
                    <td>{{value.name}}</td>
                    <td *ngIf="value.description">{{value.description}}</td>
                    <td *ngIf="!value.description">...</td>
                    <td *ngIf="value.status == 'ACTIVE'">Đang hoạt động</td>
                    <td *ngIf="value.status == 'INACTIVE'">Dừng hoạt động</td>
                    <td > <span (click)="edit(value.id,content)" style="cursor: pointer" >
                        <fa-icon icon="pencil-alt"></fa-icon>
                    </span></td>
                </tr>
                </tbody>
            </table>
        </div>
        <!-------------       phan trang        ------------>
        <div *ngIf="page" class='row justify-content-end justify-content-sm-end'>
            <select #selectSize (change)="pageItem(selectSize.value)"   class="page-items mr-1" style='height: 30px' >
                <option selected >5</option>
                <option >10</option>
                <option >15</option>
            </select>
            <p class='mt-1 mr-3'>dòng/trang. Tổng số {{page["totalElements"]}}. Hiển thị {{this.size*this.indexPage + 1}}-{{countStt()}}.  </p>
            <nav aria-label="Page navigation example">
                <ul class="pagination mr-3 mr-sm-3 mr-md-4 pr-1">

                    <!--  to start-->
                    <li style="border-color: white" >
                        <a  [ngClass]="indexPage == 0?'dis-a':''" (click)="preNextPage('start')" > <svg xmlns="http://www.w3.org/2000/svg" width="20"  height="20" style="font-size: 20px" fill="currentColor" class="bi bi-chevron-double-left" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M8.354 1.646a.5.5 0 0 1 0 .708L2.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
                            <path fill-rule="evenodd" d="M12.354 1.646a.5.5 0 0 1 0 .708L6.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
                        </svg>
                        </a>
                    </li>

                    <!--   to pre -->
                    <li style="border-color: white" class="mr-3 " >
                        <a  [ngClass]="indexPage == 0?'dis-a':''" (click)="preNextPage('pre')" >
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"  fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
                            </svg></a>
                    </li>

                    <!--   to next -->
                    <li  >
                        <a  [ngClass]="(page['totalPages'] - 1) == indexPage?'dis-a':''"  (click)="preNextPage('next')"><svg xmlns="http://www.w3.org/2000/svg"  width="20" height="20" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                        </svg></a>
                    </li>

                    <!--   to end -->
                    <li style="border-color:  white" >
                        <a [ngClass]="(page['totalPages'] - 1) == indexPage?'dis-a':''"  (click)="preNextPage('end')"><svg xmlns="http://www.w3.org/2000/svg" width="20" font-weight="bold" height="20" fill="currentColor" class="bi bi-chevron-double-right" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M3.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L9.293 8 3.646 2.354a.5.5 0 0 1 0-.708z"/>
                            <path fill-rule="evenodd" d="M7.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L13.293 8 7.646 2.354a.5.5 0 0 1 0-.708z"/>
                        </svg></a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
    <!-------------       phan trang        ------------>
    <!--     end   table                -->
</div>

<!--------- modan ---------------->

<ng-template #content let-modal>
    <div class='modal-header'>
        <h5 class='modal-title'style="font-weight: bold" >{{active}} phương thức kiểm soát</h5>
        <a  class="mr-2" (click)="modal.dismiss('Cross click')">
            <fa-icon style="font-size: 25px"  icon='times'></fa-icon>
        </a>
    </div>
    <form [formGroup]="formControlMethod">
    <div class='modal-body'>

            <div style="width: 100%" class='row'>
                <div class='col-12 col-sm-4 row'>
                    <label class='col-12 col-sm-4 col-form-label'>Mã phương thức(*)</label>
                    <div class='col-12 col-sm-8'>
                        <input type='text' [attr.disabled]="active === 'Cập nhật'?'':null"  (focus)="err001 = false" class='form-control' formControlName="code">
                        <div class="text-danger" *ngIf="formControlMethod.controls.code.errors?.required && formControlMethod.controls.code.touched">
                            Mã phương thức không được để trống
                        </div>
                        <div class="text-danger" *ngIf="!formControlMethod.controls.code.errors?.required &&
                        formControlMethod.controls.code.errors?.pattern && formControlMethod.controls.code.touched">
                            Mã phương thức chỉ được nhập kí tự in hoa ,0-9, không quá 255 ký tự
                        </div>
                        <div class="text-danger" (focus)="err001" *ngIf="err001">
                            Trường thông tin đã tồn tại
                        </div>
                    </div>
                </div>

                <div class='col-12 col-sm-4 row'>
                    <label class='col-12 col-sm-4 col-form-label'>Tên phương thức(*)</label>
                    <div class='col-12 col-sm-8'>
                        <input type='text'   class='form-control'formControlName="name" >
                        <div class="text-danger" *ngIf="formControlMethod.controls.name.errors?.required && formControlMethod.controls.name.touched">
                            Tên phương thức không được để trống
                        </div>
                        <div class="text-danger" *ngIf="
                                formControlMethod.controls.name.errors?.maxlength && formControlMethod.controls.name.touched ">
                            Tên phương thức không quá 255 ký tự
                        </div>
                        <div class="text-danger" *ngIf="!formControlMethod.controls.code.errors?.required &&
                        formControlMethod.controls.name.errors?.pattern && formControlMethod.controls.name.touched ">
                            Tên phương thức chỉ gồm các chữ cái a-z in hoa, in thường, tiếng việt có dấu, số 0-9 các ký tự đặc biệt (, ), -, _
                        </div>
                    </div>
                </div>


                <div class='col-12 col-sm-4 row'>
                    <label style="padding-right: 0px" class='col-12 col-sm-4 col-form-label text-sm-right '>Trạng thái</label>
                    <div class='col-12 col-sm-8'>
                        <select style="padding-left: 2px"  class="form-control col-12" formControlName="status">
                            <option  value="1" >Đang hoạt động</option>
                            <option  value="2" >Dừng hoạt động</option>
                        </select>
                    </div>
                </div>
            </div>
        <div class="form-group col-12 mt-2 mt-sm-0">
            <div class="row">
            <label style="padding-left: 0px" class="col-12 col-sm-1" for="exampleFormControlTextarea1">Mô tả</label>
            <textarea formControlName="description" class="form-control col-10 col-sm-10" id="exampleFormControlTextarea1" rows="3"></textarea>
                <div class="text-danger" *ngIf="formControlMethod.controls.description.errors?.maxlength ">
                    Mô tả không quá 1000 ký tự
                </div>
            </div>
        </div>
    </div>
    </form>
    <div class='modal-footer justify-content-center'>
        <button style="width: 135px!important;"  [disabled]="!formControlMethod.valid"   (click)="save()" class='mat-raised-button mat-accent btn cus-btn mr-3' >
            <svg  xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-plus-circle-fill mr-2" viewBox="0 0 16 16">
                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"/>
            </svg>
            {{active}}</button>
        <button type='button' style="background-color:#f1f1f1!important" class=' mat-raised-button btn btn-custem' (click)="modal.close('Close click')">
            Hủy
        </button>
    </div>
</ng-template>

<!------------end modan------------->

